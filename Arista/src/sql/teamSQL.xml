<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="teamSQL">

	<typeAlias alias="team" type="team.teamVO"/>
	<typeAlias alias="teamInfo" type="team.teamInfoVO"/>
	
		<!-- 리절트 맵 정의 -->
		<resultMap id="teamRes" class="team">
			<result property="team_no" column="team_no"/>
			<result property="team_id" column="team_id"/>
			<result property="team_area" column="team_area"/>
			<result property="team_type" column="team_type"/>
			<result property="team_fieldtype" column="team_fieldtype"/>
			<result property="team_age" column="team_age"/>
			<result property="team_skill" column="team_skill"/>
			<result property="team_count" column="team_count"/>
			<result property="team_intro" column="team_intro"/>
			<result property="file_savname" column="file_savname"/> <!-- 0528-추가 -->
			<result property="file_orgname" column="file_orgname"/> <!-- 0528-추가 -->
			<result property="team_regdate" column="team_regdate"/>
			<result property="team_master" column="team_master"/>
		</resultMap>
		
		<!-- 공통으로 사용할 select 절 정의 -->
		<sql id="select-all">
			select * from team
		</sql>
		
		<!-- 공통으로 사용할 where-no절 정의 -->
		<sql id="where-no">
			where team_no = #team_no#
		</sql>
		
		<select id="selectAll" resultMap="teamRes">
			<include refid="select-all" />
			ORDER BY team_no DESC
		</select>
		
		<!-- select 쿼리문 정의 -->
		<select id="selectOne" resultMap="teamRes" parameterClass="int">
			<include refid="select-all" />
			<include refid="where-no" />      
		</select>
		
		<!-- myTeam 보기 -->
		<select id="myTeamView" resultMap="teamRes" parameterClass="String">
			<include refid="select-all"/>
			where team_id=#team_id#
		</select>
		<!-- team 상세보기 -->
		<select id="teamView" resultMap="teamRes" parameterClass="int">
			<include refid="select-all"/>
			<include refid="where-no"/>
		</select>
		<!-- team 목록 -->
		<select id="teamList" resultMap="teamRes">
			<include refid="select-all"/>
			order by team_no desc
		</select>
		
		<!-- team 검색 -->
		<select id="teamSearch" resultMap="teamRes" parameterClass="String">
			<include refid="select-all"/>
			 WHERE team_id like #search# ORDER BY team_no DESC
		</select>
		
		<!-- team 멤버 보기 -->
		<select id="teamMember" resultClass="teamInfo" parameterClass="String">
			select * from teamInfo
			where mem_id=#mem_id#
		</select>
		<!-- team 멤버 리스트 -->
		<select id="teamMemberList" resultClass="teamInfo" parameterClass="String">
			select * from teamInfo
			where team_id=#team_id#
		</select>
		
		<select id="selectLastNo" resultClass="team">
			SELECT max(team_no) as team_no FROM TEAM 
		</select>

		<!-- insert 쿼리문 정의 -->
		
		<!-- team 추가 -->
		<insert id="insertTeam" parameterClass="team">
			insert into team (team_no,team_id,team_area,team_type,team_fieldtype,team_age,team_skill,team_count,team_intro,team_regdate,team_master) values (team_no_seq.NEXTVAL,#team_id#,#team_area#,#team_type#,#team_fieldtype#,#team_age#,#team_skill#,#team_count#,#team_intro#,#team_regdate#,#team_master#)
		</insert>
		
		<insert id="joinTeam" parameterClass="teamInfo">
			insert into teamInfo (team_id,mem_id,team_admin) values (#team_id#,#mem_id#,#team_admin#)
		</insert>
		
		<!-- update 쿼리문 정의 -->
		<update id="updateFile" parameterClass="team">
    			UPDATE TEAM SET FILE_ORGNAME = #file_orgname#
    		    		,FILE_SAVNAME = #file_savname#
			<include refid="where-no" />
   		 </update>
		<!-- team 수정 -->
		<update id="updateTeam" parameterClass="team">
			update team set team_id=#team_id#,team_area=#team_area#,team_type=#team_type#,team_fieldtype=#team_fieldtype#,team_age=#team_age#,team_skill=#team_skill#,team_count=#team_count#,team_intro=#team_intro#
			<include refid="where-no"/>
		</update>
		
		<update id="TeamAdmin" parameterClass="teamInfo">
			update teamInfo team_id=#team_id#,team_admin=#team_admin#,mem_id=#mem_id#
		</update>
		
		<!-- delete 쿼리문 정의 -->
		<!-- team 삭제 -->
		<delete id="deleteTeam" parameterClass="team">
			delete from team
			<include refid="where-no"/>
		</delete>
</sqlMap>